{"version":3,"file":"get-result.js","sources":["js/util.js","js/data/game-data.js","js/game/get-result.js"],"sourcesContent":["// Варианты склонения для 1 шт, 2-4 шт, 0 и 5-20 шт\nconst cases = {\n  minutes: [`минуту`, `минуты`, `минут`],\n  seconds: [`секунду`, `секунды`, `секунд`],\n  points: [`балл`, `балла`, `баллов`],\n  mistakes: [`ошибку`, `ошибки`, `ошибок`],\n  attempts: [`раз`, `раза`, `раз`],\n  fast: [`быстрый`, `быстрых`, `быстрых`]\n};\n\nexport const TimeInMs = {\n  ONE_MINUTE: 60000,\n  ONE_SECOND: 1000\n};\n\n/**\n * Переводит миллисекунды в минуты и секунды\n * @param {number} ms Миллисекунды.\n * @return {object} Время в минутах и секундах\n */\nexport const msToMinutesAndSeconds = (ms) => {\n  const minutes = Math.floor(ms / TimeInMs.ONE_MINUTE);\n  const seconds = ((ms % TimeInMs.ONE_MINUTE) / TimeInMs.ONE_SECOND).toFixed(0);\n  return {minutes, seconds};\n};\n\n/**\n * Возвращает существительное в правильном склонении\n * в зависимости от стоящего перед ним числа\n * @param {number} number Число\n * @param {string} noun Существительное\n * @return {string} Существительное в правильном склонении\n */\nexport const pluralize = (number, noun) => {\n  const nouns = cases[noun];\n\n  let n = Math.abs(number);\n\n  // Ends in 1, excluding 11\n  if (n % 10 === 1 && n % 100 !== 11) {\n    return nouns[0];\n  }\n  // Ends in 2-4, excluding 12-14\n  if (n % 10 >= 2 && n % 10 <= 4 && (n % 100 < 10 || n % 100 >= 20)) {\n    return nouns[1];\n  }\n\n  // Everything else\n  return nouns[2];\n};\n","export const GAME_SETTINGS = {\n  totalQuestions: 10,\n  totalTime: 300000, // 5 min in ms\n  fastAnswerTime: 30000, // 30 sec in ms\n  maxMistakes: 2,\n  losePoints: -1,\n  regularPoints: 1,\n  fastPoints: 2,\n  wrongPoints: -2\n};\n\nexport const GameStatus = {\n  TIMEUP: `timeup`,\n  LOSE: `lose`,\n  WIN: `win`,\n  CONTINUE: `continue`\n};\n\nexport const INITIAL_STATE = Object.freeze({\n  level: 0,\n  timeLeft: GAME_SETTINGS.totalTime,\n  mistakes: 0,\n  answers: []\n});\n","import {msToMinutesAndSeconds, pluralize} from \"../util\";\nimport {GAME_SETTINGS, GameStatus} from \"../data/game-data\";\n\nconst getResult = (state, output, points) => {\n  let result;\n\n  switch (output) {\n    case GameStatus.TIMEUP:\n      result = {\n        title: `Увы и ах!`,\n        description: `Время вышло!<br>Вы не успели отгадать все мелодии`\n      };\n      break;\n    case GameStatus.LOSE:\n      result = {\n        title: `Какая жалость!`,\n        description: `У вас закончились все попытки.<br>Ничего, повезёт в следующий раз!`\n      };\n      break;\n    case GameStatus.WIN: {\n      const time = msToMinutesAndSeconds(GAME_SETTINGS.totalTime - state.timeLeft);\n      const fastAnswers = state.answers.filter((answer) => answer.correct && answer.time < GAME_SETTINGS.fastAnswerTime).length;\n\n      result = {\n        title: `Вы настоящий меломан!`,\n        description: `За&nbsp;${time.minutes}&nbsp;${pluralize(time.minutes, `minutes`)} и ${time.seconds}&nbsp;${pluralize(time.seconds, `seconds`)}\n        <br>вы&nbsp;набрали ${points} ${pluralize(points, `points`)} (${fastAnswers} ${pluralize(fastAnswers, `fast`)})\n        <br>совершив ${state.mistakes}&nbsp;${pluralize(state.mistakes, `mistakes`)}`\n      };\n      break;\n    }\n    default: {\n      throw new Error(`Unknown result: ${output}`);\n    }\n  }\n\n  return result;\n};\n\nexport default getResult;\n"],"names":[],"mappings":"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"}